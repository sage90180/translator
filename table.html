<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta
    http-equiv="X-UA-Compatible"
    content="IE=edge"
  >
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0"
  >
  <title>Document</title>
</head>

<body>
  <textarea
    class="getHtml"
    cols="100"
    rows="2"
  ></textarea>
  <button class="magic">SAGE神奇魔法 Ｂ波Ｂ波</button>
  <textarea
    class="describe"
    cols="100"
    rows="20"
  ></textarea>
  <button class="copy">複製</button>
  <div class="displayHtml"></div>
</body>
<script>
  let displayHtml = document.querySelector('.displayHtml')
  let getHtml = document.querySelector('.getHtml')
  let magicBtn = document.querySelector('.magic')

  function handleMaginClick() {
    displayHtml.innerHTML = getHtml.value

    let titles = document.querySelectorAll('.js_toggle_activator')
    let tables = document.querySelectorAll('.js_toggle_content')
    let describe = document.querySelector('.describe')

    let str = ''

    for (i = 0; i < titles.length; i++) {
      str += `<span style="font-size:21px;"><strong>${titles[i].innerHTML}</strong></span>`
      str += tables[i].innerHTML + `<br>`
    }

    str += `<style type="text/css">.textEditor td { border: none; border-bottom: solid 1px black; padding: 7px 0px; } table , .footnote { width: 550px; } tr td:first-child {width: 250px; font-weight:900} table table td { border: none; border-bottom: solid 1px white !important; padding: 0px 0px !important } table table tr td:nth-child(2) {font-weight:500}
  </style>`

    describe.value = str
  }

  var copyBtn = document.querySelector('.copy')

  function copyHTML() {

    var content = document.querySelector('.describe')

    content.select();
    document.execCommand('copy');
  }

  magicBtn.addEventListener('click', handleMaginClick)
  copyBtn.addEventListener('click', copyHTML)
</script>

</html>